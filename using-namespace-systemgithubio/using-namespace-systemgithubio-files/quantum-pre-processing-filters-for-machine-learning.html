<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Quantum Pre-Processing Filters for Machine Learning - Using-Namespace-System.github.io</title><meta name="description" content="My previous projects exploring quantum feature space left me with more questions than answers. Recently I was given the opportunity to learn and run experiments with&nbsp;Quantum Machine Learning mentor Carlos Kuhn, the Research Chair of University of Canberra's Open Source Institute. This opportunity was made&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://using-namespace-system.github.io/quantum-pre-processing-filters-for-machine-learning.html"><link rel="alternate" type="application/atom+xml" href="https://using-namespace-system.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://using-namespace-system.github.io/feed.json"><meta property="og:title" content="Quantum Pre-Processing Filters for Machine Learning"><meta property="og:image" content="https://using-namespace-system.github.io/media/website/Capture.PNG"><meta property="og:image:width" content="394"><meta property="og:image:height" content="222"><meta property="og:site_name" content="Using-Namespace-System.github.io"><meta property="og:description" content="My previous projects exploring quantum feature space left me with more questions than answers. Recently I was given the opportunity to learn and run experiments with&nbsp;Quantum Machine Learning mentor Carlos Kuhn, the Research Chair of University of Canberra's Open Source Institute. This opportunity was made&hellip;"><meta property="og:url" content="https://using-namespace-system.github.io/quantum-pre-processing-filters-for-machine-learning.html"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://using-namespace-system.github.io/media/website/favicon-16x16.png" type="image/x-icon"><link rel="stylesheet" href="https://using-namespace-system.github.io/assets/css/style.css?v=6fbb1e8931a5afe843374fd67c192c86"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://using-namespace-system.github.io/quantum-pre-processing-filters-for-machine-learning.html"},"headline":"Quantum Pre-Processing Filters for Machine Learning","datePublished":"2024-08-01T06:14","dateModified":"2024-08-11T09:31","image":{"@type":"ImageObject","url":"https://using-namespace-system.github.io/media/website/Capture.PNG","height":222,"width":394},"description":"My previous projects exploring quantum feature space left me with more questions than answers. Recently I was given the opportunity to learn and run experiments with&nbsp;Quantum Machine Learning mentor Carlos Kuhn, the Research Chair of University of Canberra's Open Source Institute. This opportunity was made&hellip;","author":{"@type":"Person","name":"Brian Recktenwall-Calvet","url":"https://using-namespace-system.github.io/authors/brian-recktenwall-calvet/"},"publisher":{"@type":"Organization","name":"Brian Recktenwall-Calvet","logo":{"@type":"ImageObject","url":"https://using-namespace-system.github.io/media/website/Capture.PNG","height":222,"width":394}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://using-namespace-system.github.io/"><img src="https://using-namespace-system.github.io/media/website/Capture.PNG" alt="Using-Namespace-System.github.io" width="394" height="222"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://using-namespace-system.github.io/" target="_self">Home</a></li><li><a href="https://using-namespace-system.github.io/about-me.html" target="_self">About me</a></li></ul></nav><div class="search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><form action="https://using-namespace-system.github.io/search.html" class="search__form"><input class="search__input" type="search" name="q" placeholder="search..." aria-label="search..."></form><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false"><use xlink:href="https://using-namespace-system.github.io/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><article class="post"><div class="hero"><figure class="hero__image hero__image--overlay"><img src="https://using-namespace-system.github.io/media/website/computer-texture-medium-8.png" srcset="https://using-namespace-system.github.io/media/website/responsive/computer-texture-medium-8-xs.png 300w, https://using-namespace-system.github.io/media/website/responsive/computer-texture-medium-8-sm.png 480w, https://using-namespace-system.github.io/media/website/responsive/computer-texture-medium-8-md.png 768w, https://using-namespace-system.github.io/media/website/responsive/computer-texture-medium-8-lg.png 1024w, https://using-namespace-system.github.io/media/website/responsive/computer-texture-medium-8-xl.png 1360w, https://using-namespace-system.github.io/media/website/responsive/computer-texture-medium-8-2xl.png 1600w" sizes="100vw" loading="eager" alt=""></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2024-08-01T06:14">August 1, 2024</time></div><h1>Quantum Pre-Processing Filters for Machine Learning</h1><div class="post__meta post__meta--author"><img src="https://using-namespace-system.github.io/media/website/15972706_10209572272237582_6617888217074726293_o.jpg" loading="eager" height="2048" width="1796" class="post__author-thumb" alt="Brian Recktenwall-Calvet"> <a href="https://using-namespace-system.github.io/authors/brian-recktenwall-calvet/" class="feed__author">Brian Recktenwall-Calvet</a></div></div></header></div><div class="wrapper post__entry"><p>My previous projects exploring quantum feature space left me with more questions than answers. Recently I was given the opportunity to learn and run experiments with&nbsp;Quantum Machine Learning mentor <a href="https://www.linkedin.com/in/carlos-kuhn-47565b62/">Carlos Kuhn</a>, the Research Chair of University of Canberra's <a href="https://opensi.net/">Open Source Institute</a>. This opportunity was made possible by the&nbsp;<a href="https://qosf.org/qc_mentorship/">Quantum Computing Mentorship Program</a> provided by the&nbsp;<a href="https://qosf.org/" target="_blank">Quantum Open Source Foundation</a>. Each cohort they offer requires a submission including work on an assessment task. I really wracked my brain on <a href="https://github.com/Using-Namespace-System/QOSF.git" target="_blank">this one</a>. Thankfully, Carlos and some other mentors liked my assessment task submission.</p><p>The work lead by Carlos was inspired by the paper <a href="https://arxiv.org/pdf/2308.14930">Application of Quantum Pre-Processing Filter for Binary Image Classification with Small Samples</a>. The paper portrays improvements in training outcomes on a simple network when one or two quantum operations are applied as preprocessing on the MNIST dataset. However, no solid explanation is really made on the mechanisms at play that increase the training accuracy.&nbsp;</p><p>A related paper <a href="https://arxiv.org/abs/1904.04767">Quanvolutional Neural Networks: Powering Image Recognition with Quantum Circuits</a>&nbsp;is the basis for a PennyLane demonstration on using&nbsp;<a href="https://pennylane.ai/qml/demos/tutorial_quanvolution/">Quanvolutional Neural Networks</a>. The demo is a great resource for hands on experience with quantum machine learning. This helped me get familiar with PennyLane, Keras, and Tensorflow.</p><p>The core of our experimentation was set up similarly to the demo and we collected data on various changes and alternative preprocessing filters. As experiments and variations grew, collecting data on their impacts became more time intensive. Once experimentation advanced to larger sample sizes the time intensity delayed the respective data analysis and data informed future experimentation. Put more simply, it took hours to complete preprocessing and training on the full MNIST dataset.</p><p>In the paper, the quantum preprocessing is done on grayscale image values scaled to the range [0,1]. The images are 28x28 pixels, that is a 14x14 set of 2x2 squares. Each 2x2 square containing four values. In the quantum circuit, the four values are angle embedded on four wires. The best performing two-operation circuits consisted of&nbsp;CNOT operations on both diagonal pairs in the 2x2 section. The diagonal pairs are on wires (2, 1) and (0,3). Each wire is measured into a different channel resulting in 4, 14x14 images per sample. The preprocessed images are used to train a Keras model with a flat layer followed by a dense layer.</p><pre class="line-numbers language-html"><code>def quanv(image):
    """Convolves the input image with many applications of the same quantum circuit."""
    out = np.zeros((14, 14, 4))

    # Loop over the coordinates of the top-left pixel of 2X2 squares
    for j in range(0, 28, 2):
        for k in range(0, 28, 2):
            # Process a squared 2x2 region of the image with a quantum circuit
            q_results = circuit(
                [
                    image[j, k, 0],
                    image[j, k + 1, 0],
                    image[j + 1, k, 0],
                    image[j + 1, k + 1, 0]
                ]
            )
            # Assign expectation values to different channels of the output pixel (j/2, k/2)
            for c in range(4):
                out[j // 2, k // 2, c] = q_results[c]
    return out</code></pre><p>Using the looping in the demo on the full dataset would mean linearly through and applying the quantum circuit to each 2x2 segment in each 28x28 image in a set of over 10000 images. This isn't optimal.</p><pre class="line-numbers language-html"><code>#14x14 flattened 2x2 squares
get_subsections_14x14 = lambda im : tf.reshape(tf.unstack(tf.reshape(im,[14,2,14,2]), axis = 2),[14,14,4])

#unpack 14x14 row by row
list_squares_2x2 = lambda image_subsections: tf.reshape(tf.unstack(image_subsections, axis = 1), [196,4])

#send 4 values to quantum function
process_square_2x2 = lambda square_2x2 : self.q_node(square_2x2)

#send all squares to the quantum function wrapper
process_subsections = lambda squares: tf.vectorized_map(process_square_2x2,squares)

#recompile the larger square
separate_channels = lambda channel_stack: tf.reshape(channel_stack, [14,14,4])
#each smaller square (channel) can be extracted as [:, :, channel]

#apply function across batch
lambda input: tf.vectorized_map(
    lambda image:(separate_channels(tf.transpose(process_subsections(list_squares_2x2(get_subsections_14x14(image)))))),input)
</code></pre><p>Using the TensorFlow qubit device in Pennylane opens up the ability to apply quantum circuits as vector operations in TensorFlow. My approach was to use a custom Keras layer and and shape the input so that the operation can be applied across a whole batch of images at once.&nbsp;The painful process of trying to gather data and run experiments went from waiting hours to train on larger samples under&nbsp;<strong>two minutes</strong> to simultaneously preprocess and train 8 different models, each on the full dataset. On a larger scale this allowed the larger experiment below of preprocessing and training 576 different variations in 2 hours.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://using-namespace-system.github.io/media/posts/6/Screenshot-2024-08-11-092818.png" height="482" width="1230" alt="" sizes="100vw" srcset="https://using-namespace-system.github.io/media/posts/6/responsive/Screenshot-2024-08-11-092818-xs.png 300w, https://using-namespace-system.github.io/media/posts/6/responsive/Screenshot-2024-08-11-092818-sm.png 480w, https://using-namespace-system.github.io/media/posts/6/responsive/Screenshot-2024-08-11-092818-md.png 768w, https://using-namespace-system.github.io/media/posts/6/responsive/Screenshot-2024-08-11-092818-lg.png 1024w, https://using-namespace-system.github.io/media/posts/6/responsive/Screenshot-2024-08-11-092818-xl.png 1360w, https://using-namespace-system.github.io/media/posts/6/responsive/Screenshot-2024-08-11-092818-2xl.png 1600w"><figcaption>576 variations in 2 hours</figcaption></figure><p></p><p>Our ongoing experimentation is public on the TheOpenSI's GitHub repository <a href="https://github.com/TheOpenSI/QML-QPF" target="_blank">QML-QPF</a>&nbsp;</p><figure class="post__image post__image--center"><img loading="lazy" src="https://using-namespace-system.github.io/media/posts/6/MNISTMNISTqcnot0-3-2-1.gif" height="1200" width="1200" alt=""></figure></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on August 11, 2024</p><div class="post__share"></div><div class="post__bio bio"><img src="https://using-namespace-system.github.io/media/website/15972706_10209572272237582_6617888217074726293_o.jpg" loading="lazy" height="2048" width="1796" class="bio__avatar" alt="Brian Recktenwall-Calvet"><div><h3 class="bio__name"><a href="https://using-namespace-system.github.io/authors/brian-recktenwall-calvet/" rel="author">Brian Recktenwall-Calvet</a></h3><div class="bio__desc"><p>Cats and Qubits</p></div></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://using-namespace-system.github.io/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://using-namespace-system.github.io/quantum-feature-space.html" class="post__nav-link" rel="prev"><span>Previous</span> Quantum Feature Space</a></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2024-02-25T19:02" class="feed__date">February 25, 2024</time></div><h3 class="h1"><a href="https://using-namespace-system.github.io/quantum-feature-space.html">Quantum Feature Space</a></h3></article></div></div></main><footer class="footer"><div class="footer__copyright"><p><a href="Using-Namespace-System.github.io">Using-Namespace-System.github.io</a></p></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://using-namespace-system.github.io/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script defer="defer" src="https://using-namespace-system.github.io/assets/js/scripts.min.js?v=f47c11534595205f20935f0db2a62a85"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>